# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
```{r setoptions, echo=TRUE}
library(Defaults)
setDefaults('as.Date.character', format = '%Y-%m-%d')

activity <- read.csv(file='activity.csv', header=TRUE, 
                     colClasses = c("numeric","Date","numeric"))
activity.complete <- activity[complete.cases(activity),]
```

## What is mean total number of steps taken per day?
```{r}
library(lattice)
library(plyr)

activity.daily <- ddply(activity.complete, .(date), 
                        summarize, steps=sum(steps))
histogram(activity.daily$steps, breaks=15)
mean(activity.daily$steps)
median(activity.daily$steps)
```


## What is the average daily activity pattern?
```{r}
activity.daily.average <- ddply(activity.complete, .(interval), summarize, steps=mean(steps))
xyplot(steps ~ interval , data=activity.daily.average, type="l")

```


## Imputing missing values
```{r}
activity.missing <- activity[is.na(activity$steps),]
activity.missing$steps <- activity.daily.average$steps[match(activity.missing$interval, 
                                                             activity.daily.average$interval)]
activity$steps <- ifelse(is.na(activity$steps), activity.missing$steps, activity$steps)

activity.daily.complete <- ddply(activity, .(date), 
                        summarize, steps=sum(steps))
histogram(activity.daily.complete$steps, breaks=15)
mean(activity.daily.complete$steps)
median(activity.daily.complete$steps)
```

## Are there differences in activity patterns between weekdays and weekends?
```{r}
activity$day <- ifelse(weekdays(activity$date) %in% c("Saturday", "Sunday"), "weekend", "weekday")
activity.daytype <- ddply(activity, .(day, interval), summarise, steps=mean(steps))
xyplot(steps ~ interval | day, data=activity.daytype, type="l", layout=c(1, 2))
```

